<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cyber Voice Hack Challenge</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #1a1a2e, #16213e);
      color: white;
      text-align: center;
    }

    #splash {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      padding: 20px;
      box-sizing: border-box;
    }

    #splash img {
      max-width: 90%;
      width: 600px;
      border-radius: 20px;
      box-shadow: 0 0 20px #00ffcc;
      margin-bottom: 30px;
    }

    #splash button {
      padding: 14px 28px;
      font-size: 1.1rem;
      background-color: #00ffcc;
      color: black;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }

    #quiz-container {
      display: none;
      max-width: 700px;
      margin: 30px auto;
      padding: 20px;
      border-radius: 20px;
      background-color: rgba(255, 255, 255, 0.08);
      box-shadow: 0 0 20px #00ffcc;
    }

    img.question {
      width: 400px;
      height: 250px;
      object-fit: contain;
      border-radius: 10px;
      margin: 20px auto;
    }

    #champion-image {
      width: 300px;
      height: 300px;
      object-fit: contain;
      border-radius: 15px;
      margin: 20px auto;
      box-shadow: 0 0 25px #ffd700;
      animation: glow 2s ease-in-out infinite alternate;
    }

    @keyframes glow {
      from { box-shadow: 0 0 25px #ffd700; }
      to { box-shadow: 0 0 35px #ffd700, 0 0 45px #ffd700; }
    }

    h2 {
      font-size: 1.5rem;
    }

    #score, #timer {
      font-size: 1.2rem;
      font-weight: bold;
      margin: 10px 0;
    }

    #answer-status {
      font-size: 1.3rem;
      min-height: 30px;
      color: #00ffcc;
    }

    button {
      padding: 10px 20px;
      margin-top: 20px;
      background-color: #00ffcc;
      color: black;
      border: none;
      border-radius: 10px;
      font-size: 1rem;
      cursor: pointer;
    }

    .champion-text {
      color: #ffd700;
      font-size: 2rem;
      font-weight: bold;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
      margin: 20px 0;
    }
  </style>
</head>
<body>

  <!-- Splash Title -->
  <div id="splash">
    <img src="images/title.png" alt="Cyber Voice Hack Challenge" />
    <button onclick="startQuiz()">üé§ Start Quiz</button>
  </div>

  <!-- Quiz Container -->
  <div id="quiz-container">
    <img id="quiz-image" class="question" src="" alt="Cybersecurity Question" />
    <h2 id="question-text">Identify the vulnerability shown</h2>
    <div id="score">Score: 0</div>
    <div id="timer">‚è≥ Time Left: 30s</div>
    <div id="answer-status">Listening...</div>
    <button id="restart-btn" onclick="startQuiz()" style="display: none;">üîÑ Play Again</button>
  </div>

  <!-- Winner Sound Only -->
  <audio id="winner-sound" src="https://www.soundjay.com/human/sounds/applause-01.mp3"></audio>

  <script>
    const questions = [
      { 
        img: "images/sqli.jpg",
        question: "What type of attack allows attackers to manipulate database queries through user input?",
        a: ["sql injection", "sqli", "structured query language injection", "sqli attack", "SQL injection"] 
      },
      { 
        img: "images/https.jpg",
        question: "Which protocol is secure ?",
        a: ["https", "hypertext transfer protocol secure", "hyper text transfer protocol secure", "HTTPS"] 
      },
      { 
        img: "images/ransomeware.jpg",
        question: "What type of malware encrypts victim's files and demands payment for decryption?",
        a: ["ransomware", "ran somewhere", "ransome where"] 
      },
      { 
        img: "images/mitm.jpg",
        question: "What attack involves intercepting communications between two parties without their knowledge?",
        a: ["man in the middle", "mitm", "MITM", "man in the middle attack", "man inthe middle","man inthe middle attack"] 
      },
      { 
        img: "images/phishing.jpg",
        question: "What social engineering attack uses fraudulent emails to steal sensitive information?",
        a: ["phishing", "email scam", "fraud email", "spoof email", "fake login page"] 
      }
    ];

    let current = 0, score = 0, timer, timeLeft = 30;
    let recognition, recognitionActive = false;

    const splash = document.getElementById("splash"),
          quizContainer = document.getElementById("quiz-container"),
          quizImage = document.getElementById("quiz-image"),
          questionText = document.getElementById("question-text"),
          answerStatus = document.getElementById("answer-status"),
          scoreDisplay = document.getElementById("score"),
          timerDisplay = document.getElementById("timer"),
          restartBtn = document.getElementById("restart-btn"),
          winnerSound = document.getElementById("winner-sound");

    function startQuiz() {
      splash.style.display = "none";
      quizContainer.style.display = "block";
      current = 0;
      score = 0;
      scoreDisplay.textContent = "Score: 0";
      answerStatus.textContent = "Listening...";
      restartBtn.style.display = "none";
      speak("Let's begin the cybersecurity quiz!");
      if (!recognition) setupRecognition();
      showQuestion();
    }

    function setupRecognition() {
      recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      recognition.lang = 'en-US';
      recognition.interimResults = false;
      recognition.continuous = true;

      recognition.onresult = (event) => {
        const spoken = event.results[event.results.length - 1][0].transcript.toLowerCase().replace(/[^\w\s]/gi, '');
        const spokenWords = spoken.split(" ");
        const acceptedAnswers = questions[current].a;

        const isCorrect = acceptedAnswers.some(answer => {
          const normalized = answer.toLowerCase();
          return (
            spoken.includes(normalized) ||
            spokenWords.some(word => normalized.includes(word)) ||
            normalized.split(" ").every(part => spoken.includes(part))
          );
        });

        if (isCorrect) {
          clearInterval(timer);
          score++;
          scoreDisplay.textContent = `Score: ${score}`;
          answerStatus.textContent = "‚úÖ Correct!";
          speak("Correct!");
          current++;
          setTimeout(showQuestion, 2000);
        } else {
          answerStatus.textContent = "‚ùå Try again...";
          speak("That's not correct. Try again.");
        }
      };

      recognition.onerror = (e) => {
        console.error("Speech error:", e.error);
        answerStatus.textContent = `üé§ Error: ${e.error}`;
      };

      recognition.start();
      recognitionActive = true;
    }

    function showQuestion() {
      if (current >= questions.length) {
        if (score === questions.length) {
          // Perfect score - show champion image and message
          questionText.innerHTML = `<div class="champion-text">üèÜ CYBERSECURITY CHAMPION ! üèÜ</div>`;
          quizImage.src = "images/champ.jpg";
          quizImage.id = "champion-image";
          answerStatus.textContent = "üéâ Perfect Score Achieved ! üéâ";
          winnerSound.play();
          speak("Congratulations! You are a true cybersecurity champion! Perfect score achieved!");
        } else {
          questionText.textContent = `üéØ Quiz Complete!`;
          quizImage.src = "https://via.placeholder.com/400x250/34495e/ffffff?text=QUIZ+COMPLETE";
          answerStatus.textContent = `Final Score: ${score}/${questions.length}`;
          speak(`Quiz complete! Your final score is ${score} out of ${questions.length}. ${score >= 3 ? 'Well done!' : 'Keep practicing to improve your cybersecurity knowledge!'}`);
        }
        
        scoreDisplay.textContent = `Final Score: ${score}/${questions.length}`;
        timerDisplay.textContent = "";
        restartBtn.style.display = "inline-block";
        
        if (recognition && recognitionActive) {
          recognition.stop();
          recognitionActive = false;
        }
        return;
      }

      const q = questions[current];
      quizImage.src = q.img;
      quizImage.id = "quiz-image";
      questionText.textContent = q.question;
      answerStatus.textContent = "Listening...";
      timeLeft = 30;
      updateTimer();
      clearInterval(timer);
      timer = setInterval(() => {
        timeLeft--;
        updateTimer();
        if (timeLeft <= 0) {
          clearInterval(timer);
          answerStatus.textContent = "‚è±Ô∏è Time's up!";
          speak("Time's up! Moving to the next question.");
          current++;
          setTimeout(showQuestion, 2000);
        }
      }, 1000);
    }

    function updateTimer() {
      timerDisplay.textContent = `‚è≥ Time Left: ${timeLeft}s`;
    }

    function speak(text) {
      const utter = new SpeechSynthesisUtterance(text);
      utter.pitch = 1;
      utter.rate = 1;
      speechSynthesis.speak(utter);
    }
  </script>
</body>
</html>
